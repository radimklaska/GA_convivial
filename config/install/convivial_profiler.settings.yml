site_id: ''
license_key: ''
client_cleanup: true
event_tracking: true
profilers:
  set:
    name: set
    label: Set
    weight: -17
    status: true
    description: 'Checks set query parameter and saves to storage.'
    deferred: false
    sources:
      -
        type: query
        key: set
    processors:
      -
        type: temp
        key: set
    destinations:
      -
        type: set
        paths:
          - temp.set.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  unset:
    name: unset
    label: Unset
    weight: -16
    status: true
    description: 'Checks unset query parameter and unset it from storage.'
    deferred: false
    sources:
      -
        type: query
        key: unset
    processors:
      -
        type: temp
        key: unset
    destinations:
      -
        type: unset
        paths:
          - temp.unset.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  remove:
    name: remove
    label: Remove
    weight: -15
    status: true
    description: 'Checks remove query parameter and remove it from storage.'
    deferred: false
    sources:
      -
        type: query
        key: remove
    processors:
      -
        type: temp
        key: remove
    destinations:
      -
        type: remove
        paths:
          - temp.remove.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
        static_values:
          - ''
  utm_campaign:
    name: utm_campaign
    label: 'UTM campaign'
    weight: -14
    status: true
    description: 'Checks utm_campaign query parameter and set dataLayer event and saves to storage.'
    deferred: false
    sources:
      -
        type: query
        key: utm_campaign
    processors:
      -
        type: store
        key: utm_campaign
        ttl: 300
    destinations:
      -
        type: datalayer_event
        category: campaign
        action: view
        normalize: true
      -
        key: campaign_utm
        type: copy
        remove_empty: true
        paths:
          - store.utm_campaign.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  utm_source:
    name: utm_source
    label: 'UTM source'
    weight: -13
    status: true
    description: 'Checks utm_source query parameter and saves to storage.'
    deferred: false
    sources:
      -
        type: query
        key: utm_source
    processors:
      -
        type: store
        key: utm_source
        ttl: 300
    destinations:
      -
        key: utm_source
        type: copy
        remove_empty: true
        paths:
          - store.utm_source.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  utm_medium:
    name: utm_medium
    label: 'UTM medium'
    weight: -12
    status: true
    description: 'Checks utm_medium query parameter and saves to storage.'
    deferred: false
    sources:
      -
        type: query
        key: utm_medium
    processors:
      -
        type: store
        key: utm_medium
        ttl: 300
    destinations:
      -
        key: utm_medium
        type: copy
        remove_empty: true
        paths:
          - store.utm_medium.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  hour:
    name: hour
    label: Hour
    weight: -11
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: time
        key: hour
    processors:
      -
        type: store
        key: hour
        ttl: 3600
    destinations:
      -
        key: daytime
        type: range
        remove_empty: false
        paths:
          - store.hour.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
        ranges:
          -
            key: 'daytime:morning'
            min: 6
            max: 12
          -
            key: 'daytime:afternoon'
            min: 12
            max: 17
          -
            key: 'daytime:evening'
            min: 17
            max: 21
          -
            key: 'daytime:night'
            min: 0
            max: 6
          -
            key: 'daytime:night'
            min: 21
            max: 24
  author:
    name: author
    label: Author
    weight: -10
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: author
    processors:
      -
        type: dimension
        key: author
        normalize: true
    destinations:
      -
        type: datalayer_event
        category: author
        action: view
        normalize: true
  type:
    name: type
    label: Type
    weight: -9
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: type
    processors:
      -
        type: dimension
        key: type
        normalize: true
    destinations:
      -
        type: datalayer_event
        category: type
        action: view
        normalize: true
      -
        key: type_top
        type: top
        remove_empty: false
        paths:
          - dimensions.type
        storage_location:
          localstorage: localstorage
          cookie: '0'
  audience:
    name: audience
    label: Audience
    weight: -8
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: audience
    processors:
      -
        type: dimension
        key: audience
        normalize: true
    destinations:
      -
        type: datalayer_event
        category: audience
        action: view
        normalize: true
      -
        key: audience_top
        type: top
        remove_empty: false
        paths:
          - dimensions.audience
        storage_location:
          localstorage: localstorage
          cookie: '0'
  audience_crm:
    name: audience_crm
    label: 'Audience crm'
    weight: -7
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: convivial_enricher_convivial_demo_audience
    processors:
      -
        type: store
        key: audience_crm
        ttl: 300
    destinations:
      -
        key: audience_crm
        type: copy
        remove_empty: true
        paths:
          - store.audience_crm.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  audience_affinity:
    name: audience_affinity
    label: 'Audience affinity'
    weight: -6
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        default_value: 'audience:general'
        key: audience_affinity
        type: bestpick
        global_storage: true
        remove_empty: true
        paths:
          - audience_crm
          - audience_top
        storage_location:
          localstorage: localstorage
          cookie: '0'
  campaign_crm:
    name: campaign_crm
    label: 'Campaign crm'
    weight: -5
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: convivial_enricher_convivial_demo_campaign
    processors:
      -
        type: store
        key: campaign_crm
        ttl: 300
    destinations:
      -
        key: campaign_crm
        type: copy
        remove_empty: true
        paths:
          - store.campaign_crm.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  campaign_affinity:
    name: campaign_affinity
    label: 'Campaign affinity'
    weight: -4
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        default_value: ''
        key: campaign_affinity
        type: bestpick
        global_storage: true
        remove_empty: true
        paths:
          - campaign_crm
          - campaign_utm
        storage_location:
          localstorage: localstorage
          cookie: '0'
  topic:
    name: topic
    label: Topic
    weight: -3
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: topic
    processors:
      -
        type: dimension
        key: topic
        normalize: true
    destinations:
      -
        type: datalayer_event
        category: topic
        action: view
        normalize: true
      -
        key: topic_top
        type: top
        remove_empty: false
        paths:
          - dimensions.topic
        storage_location:
          localstorage: localstorage
          cookie: '0'
  topic_crm:
    name: topic_crm
    label: 'Topic crm'
    weight: -2
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: convivial_enricher_convivial_demo_topic
    processors:
      -
        type: store
        key: topic_crm
        ttl: 300
    destinations:
      -
        key: topic_crm
        type: copy
        remove_empty: true
        paths:
          - store.topic_crm.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  topic_decision_tree:
    name: topic_decision_tree
    label: 'Topic decision tree'
    weight: -1
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: decision_tree_outcome_84
    processors:
      -
        type: store
        key: topic_decision_tree
        ttl: 300
    destinations:
      -
        key: topic_decision_tree
        type: copy
        remove_empty: true
        paths:
          - store.topic_decision_tree.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
      -
        type: remove
        paths:
          - store.topic_decision_tree.value
        storage_location:
          localstorage: '0'
          cookie: cookie
        static_values:
          - decision_tree_outcome_84
  topic_affinity:
    name: topic_affinity
    label: 'Topic affinity'
    weight: 0
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        default_value: 'topic:general'
        key: topic_affinity
        type: bestpick
        global_storage: true
        remove_empty: true
        paths:
          - topic_crm
          - topic_decision_tree
          - topic_top
        storage_location:
          localstorage: localstorage
          cookie: '0'
  lifetime_value:
    name: lifetime_value
    label: 'Lifetime Value'
    weight: 1
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: price
    processors:
      -
        type: accumulation
        key: lifetime_value
    destinations:
      -
        key: lifetime_value
        type: copy
        remove_empty: false
        paths:
          - accumulators.lifetime_value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  goal:
    name: goal
    label: Goal
    weight: 2
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: goal
    processors:
      -
        type: store
        key: goal
        ttl: -1
    destinations:
      -
        type: set
        paths:
          - store.goal.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  device_type:
    name: device_type
    label: 'Device type'
    weight: 3
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: httpuseragent
        key: navigator.userAgent
    processors:
      -
        type: store
        key: device_type
        ttl: -1
    destinations:
      -
        key: device_type
        type: copy
        remove_empty: false
        paths:
          - store.device_type.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  location_country:
    name: location_country
    label: 'Location country'
    weight: 4
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: cp_country
    processors:
      -
        type: store
        key: location_country
        ttl: 0
      -
        type: map
        key: location_zone
        default_value: 'zone:australia'
        fallback_value: 'zone:international'
        mappings:
          - 'Australia|zone:australia'
          - 'AU|zone:australia'
    destinations:
      -
        key: location_country
        type: copy
        remove_empty: false
        paths:
          - store.location_country.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
      -
        key: location_zone
        type: copy
        remove_empty: true
        paths:
          - store.location_zone.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  location_lat:
    name: location_lat
    label: 'Location latitude'
    weight: 5
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: cp_latitude
    processors:
      -
        type: store
        key: location_lat
        ttl: 0
    destinations:
      -
        key: season
        type: season
        remove_empty: false
        paths:
          - store.location_lat.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
      -
        key: location_lat
        type: copy
        remove_empty: false
        paths:
          - store.location_lat.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  location_lon:
    name: location_lon
    label: 'Location longitude'
    weight: 6
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: cp_longitude
    processors:
      -
        type: store
        key: location_lon
        ttl: 0
    destinations:
      -
        key: location_lon
        type: copy
        remove_empty: false
        paths:
          - store.location_lon.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  location_city:
    name: location_city
    label: 'Location city'
    weight: 7
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: cp_city
    processors:
      -
        type: store
        key: location_city
        ttl: 0
    destinations:
      -
        key: location_city
        type: copy
        remove_empty: false
        paths:
          - store.location_city.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  pageview:
    name: pageview
    label: Pageview
    weight: 8
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors:
      -
        type: pageview
        key: pageview
        track: true
        log: false
    destinations:
      -
        key: visits
        type: copy
        remove_empty: false
        paths:
          - counters.pageview
        storage_location:
          localstorage: localstorage
          cookie: '0'
      -
        key: experience
        type: range
        remove_empty: false
        paths:
          - counters.pageview
        storage_location:
          localstorage: localstorage
          cookie: '0'
        ranges:
          -
            key: 'experience:none'
            min: 0
            max: 2
          -
            key: 'experience:low'
            min: 2
            max: 10
          -
            key: 'experience:medium'
            min: 10
            max: 100
          -
            key: 'experience:high'
            min: 100
            max: 1000000
  searchquery:
    name: searchquery
    label: Searchquery
    weight: 9
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors:
      -
        type: searchquery
        key: searchquery
        search_path: /search
        query_param: keys
        exclude_param: page
        size: 5
        track: false
        log: true
    destinations:
      -
        key: cp_search_log
        type: copy
        remove_empty: false
        json_stringify: true
        paths:
          - log.searchquery
        storage_location:
          localstorage: localstorage
          cookie: '0'
  language:
    name: language
    label: Language
    weight: 10
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: acceptlang
        key: navigator.language
    processors:
      -
        type: language_simple
        key: language-simple
        ttl: 0
      -
        type: language_full
        key: language-full
        ttl: 0
    destinations:
      -
        key: language
        type: copy
        remove_empty: false
        paths:
          - store.language-full.value
        storage_location:
          localstorage: localstorage
          cookie: '0'
  stage:
    name: stage
    label: Stage
    weight: 11
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: meta
        key: stage
    processors:
      -
        type: dimension
        key: stage
        normalize: false
    destinations:
      -
        type: datalayer_event
        category: stage
        action: view
        normalize: true
      -
        type: threshold
        paths:
          - 'dimensions.stage.stage:orientation'
        storage_location:
          localstorage: localstorage
          cookie: '0'
        threshold_number: 1
        storage_key: stage
        storage_value: 'stage:discovery'
      -
        type: threshold
        paths:
          - 'dimensions.stage.stage:discovery'
        storage_location:
          localstorage: localstorage
          cookie: '0'
        threshold_number: 2
        storage_key: stage
        storage_value: 'stage:validation'
      -
        type: threshold
        paths:
          - 'dimensions.stage.stage:validation'
        storage_location:
          localstorage: localstorage
          cookie: '0'
        threshold_number: 1
        storage_key: stage
        storage_value: 'stage:conversion'
      -
        type: threshold
        paths:
          - 'dimensions.stage.stage:conversion'
        storage_location:
          localstorage: localstorage
          cookie: '0'
        threshold_number: 2
        storage_key: stage
        storage_value: 'stage:continue'
      -
        type: threshold
        paths:
          - 'dimensions.stage.stage:converted'
        storage_location:
          localstorage: localstorage
          cookie: '0'
        threshold_number: 1
        storage_key: stage
        storage_value: 'stage:continue'
  styxkey_recombee_userid:
    name: styxkey_recombee_userid
    label: 'STYXKEY Recombee UserId'
    weight: 12
    status: true
    description: 'Copy RecombeeUserId cookie to STYXKEY_RecombeeUserId to support cookie reading on pantheon platform'
    deferred: false
    sources:
      -
        type: cookie
        key: RecombeeUserId
    processors:
      -
        type: store
        key: RecombeeUserId
        ttl: 0
    destinations:
      -
        key: STYXKEY_RecombeeUserId
        type: copy
        remove_empty: true
        json_stringify: false
        paths:
          - store.RecombeeUserId.value
        storage_location:
          localstorage: '0'
          cookie: cookie
  convivial_enricher_clientid:
    name: convivial_enricher_clientid
    label: 'Convivial Enricher ClientId'
    weight: 13
    status: true
    description: ''
    deferred: false
    sources:
      -
        type: cookie
        key: convivial_enricher_ConvivialEnricherClientId
    processors:
      -
        type: store
        key: convivial_enricher_clientid
        ttl: 0
    destinations:
      -
        key: ConvivialProfilerClientId
        type: copy
        remove_empty: false
        paths:
          - store.convivial_enricher_clientid.value
        storage_location:
          localstorage: '0'
          cookie: cookie
      -
        key: RecombeeUserId
        type: copy
        remove_empty: false
        paths:
          - store.convivial_enricher_clientid.value
        storage_location:
          localstorage: '0'
          cookie: cookie
  newsletter_signup_form:
    name: newsletter_signup_form
    label: 'Newsletter signup form'
    weight: 14
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        type: formfiller
        storage_location:
          localstorage: localstorage
          cookie: '0'
        form_selector: .newsletter-signup-form
        fields_selector:
          - crm_signup_topic|topic_affinity
          - crm_signup_audience|audience_affinity
          - crm_signup_visits|visits
          - crm_signup_country|location_country
          - crm_signup_city|location_city
      -
        type: formtracker
        form_selector: .newsletter-signup-form
        field_name: email
        event_action: formsubmit
        event_category: formtracker
  convivial_enricher_cookies_remove:
    name: convivial_enricher_cookies_remove
    label: 'Convivial enricher cookies remove'
    weight: 15
    status: true
    description: 'Remove convivial_enricher_convivial_demo_topic, convivial_enricher_convivial_demo_audience, convivial_enricher_convivial_demo_campaign cookies.'
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        type: remove
        paths:
          - store.topic_crm.value
          - store.audience_crm.value
          - store.campaign_crm.value
        storage_location:
          localstorage: '0'
          cookie: cookie
        static_values:
          - convivial_enricher_convivial_demo_topic
          - convivial_enricher_convivial_demo_audience
          - convivial_enricher_convivial_demo_campaign
  office_hours:
    name: office_hours
    label: 'Office hours'
    weight: 0
    status: true
    description: ''
    deferred: false
    sources: {  }
    processors: {  }
    destinations:
      -
        key: office_open
        type: officehours
        storage_location:
          localstorage: localstorage
          cookie: '0'
        normal_start: '2022-04-03'
        normal_end: '2022-10-01'
        normal_offset: '+10'
        daylight_saving_start: '2022-10-02'
        daylight_saving_end: '2023-04-02'
        daylight_saving_offset: '+11'
        office_start: '09'
        office_close: '17'
visibility:
  'entity_bundle:node':
    id: 'entity_bundle:node'
    negate: false
    context_mapping:
      node: '@node.node_route_context:node'
    bundles: {  }
  request_path:
    id: request_path
    negate: false
    pages: ''
  user_role:
    id: user_role
    negate: false
    context_mapping:
      user: '@user.current_user_context:current_user'
    roles: {  }
